# -*- mode: org -*-
# -*- coding: utf-8 -*-

* FAQ (基本问题?)
*** 文档本身的维护
***** 联系这个文档的作者
      | 姓名   | 邮件              | 即时工具         |        电话 |
      | 周海涛 | bartuer@gmail.com | iChat in Bonjour | 13439600330 |
***** 查看文档的HTML版本
      - 自动生成,不要在HTML做修改
***** 内容
      - 这个文档不是用户文档
        用户文档在项目的wiki:
        https://github.com/hackist/cells/wiki
      - 这个文档只记录任务及其理由，包括
        - 任务如何分割
        - 时间记录
        - 成果连接
      - 其它资料和成果的位置
        - 详细的讨论在 doc/discuss 目录下
        - 如何去做的参考文章和书籍收集在 doc/reference 目录下
        - 如果是数据收集类的任务
          - 成果出现在 data 目录下
        - 如果是编程类的任务
          - 为项目本身服务，而且代码很小(几行)，会出现在 bin 目录下
          - 为用户服务，有很多文件组成，出现在 src 目录下
        - 如果一个记录不属于文档，数据，程序的任何一类
          但有一些参考意义，不应丢弃，把它放在 log 目录下
*** 数据表格
    - SQLite3数据库和csv数据在 data 目录下
    - 如果有和csv文件同名的db文件
      - 通常这个csv是由db生成的
      - 如果db包含多个表，每个表都会生成对应的csv
        csv文件名会象这样 database_table.csv
      - 很有可能db也是由其它程序产生的
        比如bin/update_spfx 生成所有data/spfx*.*
*** 项目版本仓库
    - github
      https://github.com/hackist/cells
    - git 图形工具
      http://mac.github.com/
* 数据
*** Apple 教程
*** Youtube 频道
*** iTunes U
*** TED
    http://www.ted.com
*** TODO how to site 收集  [0/1]
    SCHEDULED: <2011-11-27 Sun 16:00>
    - [ ] http://www.maclearning.com
* development
*** UI design
***** TODO video meaning editor UI
***** TODO video tag selector UI
***** TODO image stream viewer
***** TODO build desktop application link parts by transition to try video Editor UI
*** audio 
***** HALT combine audio track to video file
      - ffmpeg has serious lost frames problem, it could combine sound,
        but video quality is damaged
      - seems the problem due to not use x264 properly, Sorenson
        squeeze also has such problem
      - should be fixed after apply encode code from HandBrake
***** DONE split audio track out of video
      #!/bin/bash
      ffmpeg -i $1 -vn -acodec copy $1.`afinfo /tmp/sound |head -2|tail -1|cut -d ':' -f 2|sed -e 's/ //g;s+f$++g;s+WAVE+wav+g;s+MPG3+mp3+g;s+ac-3+ac3+g;s+AIFF+aif+g;s+3gpp+3gp+g'`
      - only extract audio file out is very fast, but convert format
        will be very slow, need aac -> wav -> mp3, is there any fast
        mp3 encoder?
      - only mp3 can be stream from web
        afconvert -v -f AIFF $1 --data BEI16@44100 $1.aif && lame
        $1.aif $1.mp3
***** DONE make lion tts output audio file
      #!/bin/sh
      say -o /tmp/h.aif -f $1 && afconvert -v -f m4af -d aac -b 64000 /tmp/h.aif $1.m4a  && afinfo $1.m4a
      1s sound, 20ms generate and compress time, 8k bandwidth
***** TODO tts service [1/7]
      - [X] basic idea
        (shell-command "qlmanage -p 2>/dev/null ./doc/bonjour.ting-ting.emlx")
      - [ ] http service first
            use Safari test it
      - [ ] compare install Node.js and uki gems
      - [ ] daemon it
      - [ ] package it
            - check OS
            - voice dependency
      - [ ] embedded VPN connection?
      - [ ] why not make it available on Mac App store?
*** image
***** DONE convert video to image stream
        #!/bin/bash
        mkdir thumb-$1 
        ffmpeg -i $1 -r 1 -s qqvga -f image2 thumb-$1/thumb-$1-%04d.png
        for f in thumb-$1/*.png; do
          convert -quality 80 $f thumb-$1/`basename -s .png $f`.jpg && rm $f
        done
      - take look at handbrake
        it build own encoder? 
        - clone github keep failed
          svn mirror?
        - just download the tarball
      - image sample quality
      - it is possible to embedded images into audio stream, it seems
        pretty cool bandwidth saving method
        http://developer.apple.com/library/ios/#documentation/AudioVideo/Conceptual/HTTP_Live_Streaming_Metadata_Spec/2/2.html#//apple_ref/doc/uid/TP40010435-CH2-DontLinkElementID_2
***** DONE empty image stream
      just draw some rectangle on client
      for audio only case
***** TODO merge image sequence into audio track [0/4]
      - [ ] it is last fall back when bandwidth in not enought
      - [ ] it seems better than audio book
      - [ ] it can be done with http stream server
      - [ ] how to merge this with slide show video making
            - is it possible to wrap quartz composer into mpeg-2
              transport stream packet?
            - the experience will be seamless?
***** TODO automatic slideshow video making [0/4]
      - [ ] image pool
      - [ ] music pool
      - [ ] extend transition library
      - [ ] stream video on demand
*** video
***** TODO workflow  [1/2]                                         :research:
      SCHEDULED: <2011-11-27 Sun 12:00>
      - [X] take look at podcast producer
            it has document and tutorial
      - [ ] need make video tutorial for self work flow?
            - should make it as automatically as possible
***** TODO HLS tool [1/2]
      SCHEDULED: <2011-12-10 Sat 17:00>
      :PROPERTIES:
      :Effort:   8:00
      :END:
      - [X] project plot
            - segmenter in commercial software all has serious limitation
              - have try 
                - Apple developer tool
                - Final Cut Pro X
                - Sorenson Squeeze
              - OS platform
              - cluster support
              - configure knowledge management
                - share
                - update
                - tuning
              - customize process or work flow
            - architecture
               - facility graphic chip can achieve below 10 times
                 - CUDA of Nvidia
                 - GPGPU of AMD
                 - video sync of Intel 
                 - OpenCL of Apple
               - programming to reuse the middle result can achieve about 10 times    
                 - 2 screen size x 3 bandwidth x 2 delivery format at least           
                 - Final Cut Pro X queue them for encoding on multiple machine        
                 - Sorenson seems use middle result
               - cluster method indeed can achieve more than 100 times
                 - now network bandwidth is 1000 times higher than normal encoding rate
                 - it is much easier to achieve high performance by programming on
                   socket than on graphic chip API or OS specific thread model
            - input/output coverage requirement
                  - bandwidth range
                    - cellar
                    - 3G
                    - ADSL
                    - WiFi
                  - bandwidth grain
                    - 2 grade each network
                    - only 1 for WiFi network
                  - device range
                    - iphone
                    - ipad
                    - AppleTV
                    - WebKit browser
                  - multimedia track
                    - video and audio
                    - audio and still image
                  - container
                    - mp4 for progressive download
                    - ts for HLS
                    - hinted mov for QuickTime stream server
                  - input
                    - QuickTime screen record raw
                    - QuickTime screen record export
                  - preset reference
                    (link "data/hls_guild.csv" 7591)
            - basic encoding and encoder choosing
                  - video
                    x264 H264 AVR, HandBrake patched version 
                  - audio
                    - Chrome can play mp4 with AAC audio?
                    - iPhone can play m4v with mp3 audio?
                    - choose one most compatible
                    - use faac or lame after decision
                  - dependency
                    - should balance between supported format and complexity
                    - now it is indeed single input and output format
                  - platform
                    - at least *nix
                    - first only Unix Makefile
                    - should works on both 32/64 Mac and 32/64 Linux
                    - if need UI component
                      - migrate to XCode project
                      - use CMake
            - dependency
              - should balance between supported formats and complexity
              - now it is indeed single input and output format
            - compilation platform
              - at least *nix
              - first only Unix Makefile
              - should works on both 32/64 Mac and 32/64 Linux
              - if need UI component
                - migrate to XCode project
                - use CMake
      - [ ] prepare test data
            - prepare sound first
            - progressive download as source of segment
            - 5 minutes 800x600 of Mac shared screen
              - spotlight usage
              - versions
                - download full size
                  hb -i -o -e x264 --x264-preset ultrafast \
                  --x264-profile baseline \
                  -x ref=2:bframes=2:subq=6:mixed-refs=0:weightb=0:8x8dct=0:trellis=0 \
                  --x264-tune zerolatency -r 5 -vfr \
                  --strict-anamorphic  \
                  -T -2 -b 183 \
                  -9 -f mp4 -4 -m
                - stream iPad size 156k/512
            - 20 seconds 326x496 of iPhone simulator
              - webapp usage
              - versions 
                - download full size
                - stream iPhone version 110k/260
            - 20 seconds 512x384 of iPad simulator
              - reuse content of iPhone one
              - versions
                - download/progressive full size
                - stream iPad size 156k/512
                - stream iPhone size 110k/260
            - download version add meta data
            - add meta data to MpegTS packet
            - script to setup record windows
****** TODO huge file upload and download [0/6]
      - [ ] mongrel2 solution
      - [ ] node.js solution
      - [ ] upload client
      - [ ] server configure support break recover
      - [ ] try cloudfront AWS
      - [ ] try new location of linode
***** DONE preset of encode according to bandwidth and screen size settings [5/5]
      - [X] profile
            (link "doc/encoders.eml" 1)
            - standard specification
            - profile database 
            - tweak profile for screen capture
            - collect high quality movie's profile
              - like earthtouch or Apple trailers
              - Final cut has such feature
            - export sample profile from popular transcoder
      - [X] x264
            - encoder in Handbrake
              I think it's result seems much better than MC
            - learn it's algorithm
            - there is H.264 CUDA
            - it can be used in ffmpeg
      - [X] encoder in Final Cut
            - compressor
              - AIC -> ResPro
              - they use Main Concept before
            - QuickTime Framework in general
      - [X] hardware accelerated encoder library
            - CUDA
              it is most available now
            - video sync of Intel
            - GPGPU of AMD
      - [X] commercial encoder
            - Main Concept
              it support CUDA, but my card only has 253M memory, that
              need at least 512M
            - Squeeze
              - how to remove 3.6M video's water mark ?
                do not need that
              - how could encoder know video should choose static or
                motion profile?
                indeed there is no such significant difference there
***** TODO reference movie [2/4]
      SCHEDULED: <2011-11-27 Sun 14:00>
      - [X] take look at QuickTime export format
      - [X] javascript control
      - [ ] browser native control
      - [ ] page structure
***** TODO profile collection [1/3] 
      SCHEDULED: <2011-12-10 Sat 16:00>
      :PROPERTIES:
      :Effort:   3:00
      :END:
      - [X] from software
            - squeeze
              (link "./data/spfx_single.csv" 3449)
            - handbrake
            - final cut HLS output
      - [ ] from code
            - http stream
            - ffmpeg
            - x264
      - [ ] from document
            - stream media guide
***** TODO setup http streaming server [0/4]
      - [ ] migrate my server from SF to Tokyo
      - [ ] benchmark local and VPS
      - [ ] stream audio first
      - [ ] HLS segment
***** TODO automatically script driven capture [1/2]               :research:
      - [X] is it possible use script driven capture
            - can make that script downloadable
            - try it, pretty hard, abandon
      - [ ] programming API of QuickTime or Capture software
            - macruby as glue language?
            - have take look at js as system script language on OSX possibility?
***** TODO video effect and transitions [0/2]
      - [ ] filter matrixs in CoreImage library
      - [ ] quartz composer make video transition
***** TODO research on overlay
      it is useful to display two part (keyboard, touch) meanwhile
*** deployment
***** TODO main site at bartuer's linode machine
***** TODO use Youku as CDN
***** TODO try amazon GPU cluster farm
*** project maintain
***** DONE github repository [2/2]
      SCHEDULED: <2011-11-27 Sun 18:00>
      - [X] branch based process
            - now just commit on master is okay
      - [X] not pull request
***** TODO site server data and document [1/1]
      SCHEDULED: <2011-11-26 Sat 13:30>
      CLOCK: [2011-11-26 Sat 13:18]--[2011-11-26 Sat 14:05] =>  0:47
      :PROPERTIES:
      :Effort:   0:30
      :Clockhistory: 1
      | :Clock1: | [2011-11-26 Sat 13:18]--[2011-11-26 Sat 14:05] =>  0:47 | init |   47 |
      |          |                                                         |      | 0.78 |
      #+TBLFM: $4='(convert-time-to-minutes $2)::@2$4=vsum(@1..@1)/60;%.2f
      :END:
      - [X] automatically convert this document
***** TODO setup working network environment [2/7]
      SCHEDULED: <2011-11-27 Sun 10:00>
      - [X] fast network
      - [X] storage
      - [ ] service finding
            - DNS configure
            - bonjour name convention
      - [ ] document browser
      - [ ] document edit
      - [ ] notification
      - [ ] iChat server can save conversation?
            - can route irc to jabberd?
            - how to integrate with my realtime comments
            - pin idea here, will setup new one when chance coming
